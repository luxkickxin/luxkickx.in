<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>LuxKickx.in | Streetwear Cool Sneakers</title>
  <style>
    body {
      margin: 0;
      font-family: "Poppins", sans-serif;
      background: #0f0f0f;
      color: white;
      text-align: center;
      min-height: 100vh;
    }
    header {
      background: #111;
      padding: 15px 0;
      font-size: 1.8em;
      font-weight: bold;
      color: #fff;
      letter-spacing: 1px;
    }
    .product-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      padding: 20px;
    }
    .product {
      background: #1b1b1b;
      border-radius: 15px;
      padding: 15px;
      box-shadow: 0 0 10px rgba(255,255,255,0.1);
      transition: 0.3s;
    }
    .product:hover {
      transform: scale(1.03);
      box-shadow: 0 0 15px rgba(255,255,255,0.2);
    }
    .product img {
      width: 100%;
      border-radius: 10px;
      height: 200px;
      object-fit: cover;
    }
    button {
      background: #ff3131;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 10px;
      cursor: pointer;
      font-size: 1em;
      margin-top: 10px;
      transition: 0.3s;
    }
    button:hover {
      background: #ff4f4f;
    }
    input {
      width: 90%;
      padding: 10px;
      margin: 8px 0;
      border-radius: 8px;
      border: none;
    }
    #adminPanel {
      display: none;
      background: #111;
      padding: 20px;
      border-radius: 10px;
      width: 90%;
      max-width: 450px;
      margin: 20px auto;
    }
    #loginButton {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: #ff3131;
      color: white;
      border: none;
      padding: 12px 18px;
      border-radius: 30px;
      font-size: 1em;
      cursor: pointer;
      box-shadow: 0 0 10px rgba(255,255,255,0.2);
      transition: 0.3s;
      z-index: 999;
    }
    #loginButton:hover {
      background: #ff4f4f;
    }
    #loginBox {
      display: none;
      position: fixed;
      bottom: 80px;
      right: 20px;
      background: #1a1a1a;
      border-radius: 10px;
      padding: 15px;
      box-shadow: 0 0 10px rgba(255,255,255,0.2);
      z-index: 1000;
    }
    #loginBox input {
      width: 100%;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <header>LuxKickx.in</header>

  <!-- Admin floating button -->
  <button id="loginButton" onclick="toggleLoginBox()">Admin</button>

  <!-- Admin login box (Firebase Auth login) -->
  <div id="loginBox">
    <input type="email" id="adminEmail" placeholder="Admin Email" />
    <input type="password" id="adminPwd" placeholder="Password" />
    <button onclick="adminLogin()">Login</button>
    <button onclick="adminLogout()">Logout</button>
  </div>

  <!-- Admin Panel -->
  <div id="adminPanel">
    <h3>🧠 Admin Panel</h3>
    <input type="text" id="name" placeholder="Product Name" /><br />
    <input type="text" id="price" placeholder="Price (₹)" /><br />
    <input type="text" id="imgUrl" placeholder="Image URL (https://...)" /><br />
    <button onclick="addProduct()">Add Product</button>
    <hr>
    <h4>WhatsApp Numbers (for order)</h4>
    <input type="text" id="num1" placeholder="First WhatsApp number (include country code)" />
    <input type="text" id="num2" placeholder="Second WhatsApp number" />
    <button onclick="updateNumbers()">Update Numbers</button>
    <hr>
    <h4>Custom Button</h4>
    <input type="text" id="btnName" placeholder="Button Name (e.g., Spin & Win)" />
    <input type="text" id="btnLink" placeholder="Button Link (https://...)" />
    <button onclick="updateButton()">Update Button</button>
    <button onclick="removeButton()">Remove Button</button>
  </div>

  <!-- Public products grid -->
  <div class="product-grid" id="productGrid"></div>

  <!-- Custom button from DB -->
  <div id="customBtnContainer"></div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getDatabase, ref, set, push, onValue, get, remove } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    // 🔥 Firebase setup
    const firebaseConfig = {
// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyCzQhRfnpQ_NjYioRBk3trDxyTm8HAnQK8",
  authDomain: "luxkickx-cc5fc.firebaseapp.com",
  databaseURL: "https://luxkickx-cc5fc-default-rtdb.asia-southeast1.firebasedatabase.app",
  projectId: "luxkickx-cc5fc",
  storageBucket: "luxkickx-cc5fc.firebasestorage.app",
  messagingSenderId: "342523101809",
  appId: "1:342523101809:web:6e2322d117023bc7b891d0"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
    };
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const auth = getAuth();

    // global state
    let isAdmin = false;
    let whatsappNumbers = { num1: "", num2: "" };

    // 🔑 toggle login box
    window.toggleLoginBox = function () {
      const box = document.getElementById("loginBox");
      box.style.display = box.style.display === "block" ? "none" : "block";
    };

    // 🔐 login/logout functions
    window.adminLogin = async function () {
      const email = document.getElementById("adminEmail").value.trim();
      const pwd = document.getElementById("adminPwd").value;
      if (!email || !pwd) return alert("Enter email & password");
      try {
        await signInWithEmailAndPassword(auth, email, pwd);
      } catch (err) {
        alert("Login failed: " + err.message);
      }
    };
    window.adminLogout = async function () {
      await signOut(auth);
      alert("Logged out");
    };

    // 👀 auth state watcher
    onAuthStateChanged(auth, async (user) => {
      const panel = document.getElementById("adminPanel");
      const btn = document.getElementById("loginButton");
      if (!user) {
        isAdmin = false;
        panel.style.display = "none";
        btn.style.display = "block";
        return;
      }
      const adminSnap = await get(ref(db, "admins/" + user.uid));
      if (adminSnap.exists() && adminSnap.val() === true) {
        isAdmin = true;
        panel.style.display = "block";
        btn.style.display = "none";
      } else {
        isAdmin = false;
        await signOut(auth);
        alert("Not authorized!");
      }
    });

    // 🧩 Add product
    window.addProduct = async function () {
      const name = document.getElementById("name").value.trim();
      const price = document.getElementById("price").value.trim();
      const imgUrl = document.getElementById("imgUrl").value.trim();
      if (!name || !price || !imgUrl) return alert("Fill all product fields");
      await push(ref(db, "products"), { name, price, img: imgUrl, time: Date.now() });
      alert("✅ Product added!");
      document.getElementById("name").value = "";
      document.getElementById("price").value = "";
      document.getElementById("imgUrl").value = "";
    };

    // 🧹 Delete product
    window.deleteProduct = async function (id) {
      if (!isAdmin) return alert("Only admin can delete");
      await remove(ref(db, "products/" + id));
      alert("🗑️ Product deleted!");
    };

    // 🛒 Load products
    const grid = document.getElementById("productGrid");
    onValue(ref(db, "products"), (snap) => {
      grid.innerHTML = "";
      snap.forEach((child) => {
        const p = child.val();
        const id = child.key;
        const div = document.createElement("div");
        div.className = "product";
        div.innerHTML = `
          <img src="${p.img}" alt="${p.name}" />
          <h3>${p.name}</h3>
          <p>₹${p.price}</p>
          <button onclick="chooseNumber('${p.name}', '${p.price}')">Buy Now</button>
          ${isAdmin ? `<button onclick="deleteProduct('${id}')">Delete</button>` : ""}
        `;
        grid.appendChild(div);
      });
    });

    // 💬 Load WhatsApp numbers
    onValue(ref(db, "whatsapp"), (snap) => {
      if (snap.exists()) whatsappNumbers = snap.val();
    });

    // ✏️ Update WhatsApp numbers
    window.updateNumbers = async function () {
      const num1 = document.getElementById("num1").value.trim();
      const num2 = document.getElementById("num2").value.trim();
      if (!num1 || !num2) return alert("Enter both numbers!");
      await set(ref(db, "whatsapp"), { num1, num2 });
      alert("✅ Numbers updated!");
    };

    // 🛍️ Choose WhatsApp number for order
    window.chooseNumber = function (name, price) {
      if (!whatsappNumbers.num1 || !whatsappNumbers.num2)
        return alert("Numbers not set yet");
      const msg = encodeURIComponent(`Hi! I'm interested in ${name} (₹${price})`);
      const num = prompt(`Choose number:\n1️⃣ ${whatsappNumbers.num1}\n2️⃣ ${whatsappNumbers.num2}\nType 1 or 2`);
      if (num === "1") window.open(`https://wa.me/${whatsappNumbers.num1}?text=${msg}`, "_blank");
      else if (num === "2") window.open(`https://wa.me/${whatsappNumbers.num2}?text=${msg}`, "_blank");
      else alert("Invalid choice");
    };

    // 🎯 Custom button (Spin & Win etc.)
    onValue(ref(db, "customButton"), (snap) => {
      const container = document.getElementById("customBtnContainer");
      container.innerHTML = "";
      if (snap.exists()) {
        const data = snap.val();
        const btn = document.createElement("button");
        btn.textContent = data.name;
        btn.onclick = () => window.open(data.link, "_blank");
        container.appendChild(btn);
      }
    });

    // ✏️ Update / Remove custom button
    window.updateButton = async function () {
      const name = document.getElementById("btnName").value.trim();
      const link = document.getElementById("btnLink").value.trim();
      if (!name || !link) return alert("Enter button name & link!");
      await set(ref(db, "customButton"), { name, link });
      alert("✅ Button updated!");
    };
    window.removeButton = async function () {
      await remove(ref(db, "customButton"));
      alert("❌ Button removed!");
    };
  </script>
</body>
</html>
